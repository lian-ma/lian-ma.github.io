I"ŠŒ<h3 id="å‰è¨€">å‰è¨€</h3>

<p><strong>Navigation</strong> ç”¨äºç®¡ç† APP é¡µé¢è·³è½¬å¯¼èˆªï¼Œåˆ‡æ¢ fragment æ›´åŠ ç›´è§‚ï¼Œå¯è§†åŒ–ç•Œé¢å±•ç¤º fragment çš„åˆ‡æ¢æµç¨‹å›¾</p>

<blockquote>
  <p>æ³¨æ„ï¼šç›®å‰ Jetpack æ¶æ„ç»„ä»¶éœ€è¦è¿è¡Œåœ¨ Android Studio 3.2 ä»¥ä¸Š</p>
</blockquote>

<blockquote>
  <p>ä»¥ä¸‹éƒ¨åˆ†å†…å®¹æ‘˜æŠ„è‡³å®˜æ–¹æ–‡æ¡£</p>
</blockquote>

<p><strong>Navigation</strong> ç»„ä»¶åŠŸèƒ½ï¼š</p>

<ol>
  <li>è‡ªåŠ¨å¤„ç† Fragment ç¢ç‰‡äº‹åŠ¡</li>
  <li>é»˜è®¤å¤„ç†è¿”å›é”®å’Œä¸Šä¸€æ­¥çš„æ“ä½œ</li>
  <li>åŠ¨ç”»å’Œè¿‡æ¸¡çš„é»˜è®¤è¡Œä¸º</li>
  <li>é»˜è®¤é¡µé¢ä»¥åŠä¸‹ä¸€å±‚çš„é“¾æ¥æ“ä½œ</li>
  <li>ç”¨å¾ˆå°‘çš„ä»£ç å»å®ç°å¯¼èˆªç•Œé¢ï¼ˆä¾‹å¦‚å¯¼èˆªæŠ½å±‰å’Œåº•éƒ¨å¯¼èˆªï¼‰</li>
  <li>å¯¼èˆªåˆ‡æ¢ç•Œé¢ä¹‹é—´çš„å‚æ•°ä¼ é€’</li>
  <li>åœ¨ Android Studio ä¸­ä¸€ä¸ªå¯è§†åŒ–çš„ Navigation æ“ä½œç•Œé¢</li>
</ol>

<p><strong>Navigation</strong> ç»„ä»¶ä¸»è¦åŒ…æ‹¬çš„ä¸‰ä¸ªéƒ¨åˆ†ï¼š</p>

<ol>
  <li>Navigation Graph (ä¸€ç§æ–°ç‰ˆçš„XMLæ–‡ä»¶)ï¼Œæ˜¯ä¸€ä¸ªé›†ä¸­åŒ…å«äº†æ‰€æœ‰ Navigation ç›¸å…³çš„ä¿¡æ¯çš„ä¸€ç§æ–°ç‰ˆçš„XMLæ–‡ä»¶ã€‚å®ƒåŒ…æ‹¬ app ä¸­çš„æ‰€æœ‰ç•Œé¢ï¼ˆActivityæˆ–Fragmentï¼‰ï¼Œä»¥åŠç”¨æˆ·å¯ä»¥é€šè¿‡ app è®¿é—®çš„å¯èƒ½è·¯å¾„ã€‚</li>
  <li>NavHostFragment ï¼ˆLayout XML viewï¼‰ï¼Œè¿™æ˜¯ä¸€ä¸ªæ·»åŠ åˆ°å¸ƒå±€ä¸­çš„ç‰¹æ®Šéƒ¨ä»¶ã€‚avHostFragment é€šè¿‡ navGraph ä¸ navigation å¯¼èˆªç¼–è¾‘å™¨è¿›è¡Œå…³è”ã€‚</li>
  <li>NavController(Kotlin/Java object),è¿™æ˜¯ä¸€ä¸ªè·Ÿè¸ªå¯¼èˆªå›¾ä¸­å½“å‰ä½ç½®çš„å¯¹è±¡ï¼Œå½“æ‚¨åœ¨å¯¼èˆªå›¾ä¸­ç§»åŠ¨æ—¶ï¼Œå®ƒåè°ƒäº¤æ¢ navhostfragment ä¸­çš„ç›®æ ‡å†…å®¹ã€‚</li>
</ol>

<p>å½“ä½ å¯¼èˆªæ—¶ï¼Œä½ å°†ä½¿ç”¨å¯¼èˆªæ§åˆ¶å™¨å¯¹è±¡ï¼Œå‘Šè¯‰å®ƒä½ æƒ³å»å“ªé‡Œï¼Œæˆ–è€…ä½ æƒ³åœ¨ä½ çš„å¯¼èˆªå›¾ä¸­èµ°ä»€ä¹ˆè·¯å¾„ã€‚ç„¶åï¼Œå¯¼èˆªæ§åˆ¶å™¨å°†åœ¨ NavHostframent ä¸­æ˜¾ç¤ºé€‚å½“çš„ç›®çš„åœ°ã€‚</p>

<p>ä¸‹é¢å·²<strong>åº•éƒ¨å¯¼èˆªåˆ‡æ¢ fragment</strong> ä¸ºä¾‹å­ï¼Œæ¥ç®€å•è®²è¯‰ Navigation åŸºç¡€ä½¿ç”¨æ–¹æ³•</p>

<hr />
<h3 id="demo">Demo</h3>
<blockquote>
  <p><strong><a href="https://github.com/lian-ma/JetpackDemo">ä¼ é€ï¼ä¼ é€ï¼ä¼ é€</a></strong></p>
</blockquote>

<p><strong>æ‰€éœ€ä¾èµ–</strong></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">implementation</span> <span class="err">'</span><span class="n">androidx</span><span class="o">.</span><span class="na">navigation</span><span class="o">:</span><span class="n">navigation</span><span class="o">-</span><span class="nl">fragment:</span><span class="mf">2.2</span><span class="o">.</span><span class="mi">0</span><span class="o">-</span><span class="n">rc03</span><span class="err">'</span>
<span class="n">implementation</span> <span class="err">'</span><span class="n">androidx</span><span class="o">.</span><span class="na">navigation</span><span class="o">:</span><span class="n">navigation</span><span class="o">-</span><span class="nl">ui:</span><span class="mf">2.2</span><span class="o">.</span><span class="mi">0</span><span class="o">-</span><span class="n">rc03</span><span class="err">'</span>
</code></pre></div></div>

<p><strong>ç›¸å…³é…ç½®</strong></p>

<p>fragment çš„è·³è½¬æ˜¯é€šè¿‡ xml æ–‡ä»¶é…ç½®ï¼Œæ¯”å¹³å¸¸çš„ FragmentManager ç®¡ç† fragment æ–¹ä¾¿çš„å¤šï¼Œä¸Šé¢çš„ç»„ä»¶åŠŸèƒ½å·²ç»è¯´çš„å¾ˆæ˜ç¡®å•¦ï¼</p>

<ul>
  <li>*æ–°å»ºä¸‰ä¸ª fragment å’Œä¸€ä¸ª activity ï¼Œåå­—éšæ„ï¼ŒoneFragmentã€twoFragmentã€threeFtagmentã€MainActivity</li>
  <li>
    <p>*</p>
  </li>
  <li><em>åˆ›å»ºåä¸º navigation çš„æ–‡ä»¶å¤¹ï¼Œè·¯å¾„ä¸º app &gt; src &gt; main &gt; res &gt; navigationï¼Œåœ¨ navigation æ–‡ä»¶å¤¹ä¸‹é¢æ–°å»º xxx.xml æ–‡ä»¶ï¼Œä»¥ä¸‹ç¤ºä¾‹ä»£ç ï¼š</em>
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="o">&lt;?</span><span class="n">xml</span> <span class="n">version</span><span class="o">=</span><span class="s">"1.0"</span> <span class="n">encoding</span><span class="o">=</span><span class="s">"utf-8"</span><span class="o">?&gt;</span>
  <span class="o">&lt;</span><span class="n">navigation</span>
      <span class="nl">xmlns:</span><span class="n">android</span><span class="o">=</span><span class="s">"http://schemas.android.com/apk/res/android"</span>
      <span class="nl">xmlns:</span><span class="n">app</span><span class="o">=</span><span class="s">"http://schemas.android.com/apk/res-auto"</span>
      <span class="nl">xmlns:</span><span class="n">tools</span><span class="o">=</span><span class="s">"http://schemas.android.com/tools"</span>
      <span class="nl">android:</span><span class="n">id</span><span class="o">=</span><span class="s">"@+id/nav_graph_main"</span>
      <span class="nl">app:</span><span class="n">startDestination</span><span class="o">=</span><span class="s">"@id/oneFragment"</span><span class="o">&gt;</span><span class="c1">//startDestination æœ€ç›´è§‚çš„ç¿»è¯‘â€œå‡ºå‘åœ°â€,å°±æ˜¯è®¾ç½®é»˜è®¤çš„èµ·å§‹é¡µ</span>
      <span class="cm">/**
       * name ä¸º fragment è·¯å¾„
       * layout ä¸º fragment çš„ layout æ–‡ä»¶
       **/</span>
      <span class="o">&lt;</span><span class="n">fragment</span>
          <span class="nl">android:</span><span class="n">id</span><span class="o">=</span><span class="s">"@+id/oneFragment"</span>
          <span class="nl">android:</span><span class="n">name</span><span class="o">=</span><span class="s">"com.smodock.jetpackdemo.fragment.OneFragment"</span>
          <span class="nl">android:</span><span class="n">label</span><span class="o">=</span><span class="s">"fragment_one"</span>
          <span class="nl">tools:</span><span class="n">layout</span><span class="o">=</span><span class="s">"@layout/fragment_one"</span><span class="o">&gt;</span>
          <span class="cm">/**
           * destination æŒ‡å®šè·³è½¬çš„ fragment
           * enterAnim æŒ‡å®šè¿›å…¥åŠ¨ç”» 
           * exitAnim æŒ‡å®šé€€å‡ºåŠ¨ç”»
           * popEnterAnim æŒ‡å®šå¼¹å…¥åŠ¨ç”»
           * popExitAnim æŒ‡å®šå¼¹å‡ºåŠ¨ç”»
           **/</span>
          <span class="o">&lt;</span><span class="n">action</span>
              <span class="nl">android:</span><span class="n">id</span><span class="o">=</span><span class="s">"@+id/action_oneFragment_to_twoFragment2"</span>
              <span class="nl">app:</span><span class="n">destination</span><span class="o">=</span><span class="s">"@id/twoFragment"</span>
              <span class="nl">app:</span><span class="n">enterAnim</span><span class="o">=</span><span class="s">"@anim/slide_in_right"</span><span class="o">/&gt;</span>
      <span class="o">&lt;/</span><span class="n">fragment</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">fragment</span>
          <span class="nl">android:</span><span class="n">id</span><span class="o">=</span><span class="s">"@+id/twoFragment"</span>
          <span class="nl">android:</span><span class="n">name</span><span class="o">=</span><span class="s">"com.smodock.jetpackdemo.fragment.TwoFragment"</span>
          <span class="nl">android:</span><span class="n">label</span><span class="o">=</span><span class="s">"fragment_two"</span>
          <span class="nl">tools:</span><span class="n">layout</span><span class="o">=</span><span class="s">"@layout/fragment_two"</span> <span class="o">&gt;</span>
          <span class="o">&lt;</span><span class="n">action</span>
              <span class="nl">android:</span><span class="n">id</span><span class="o">=</span><span class="s">"@+id/action_twoFragment_to_threeFragment"</span>
              <span class="nl">app:</span><span class="n">destination</span><span class="o">=</span><span class="s">"@id/threeFragment"</span>
              <span class="nl">app:</span><span class="n">enterAnim</span><span class="o">=</span><span class="s">"@anim/slide_in_right"</span><span class="o">/&gt;</span>
      <span class="o">&lt;/</span><span class="n">fragment</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">fragment</span>
          <span class="nl">android:</span><span class="n">id</span><span class="o">=</span><span class="s">"@+id/threeFragment"</span>
          <span class="nl">android:</span><span class="n">name</span><span class="o">=</span><span class="s">"com.smodock.jetpackdemo.fragment.ThreeFragment"</span>
          <span class="nl">android:</span><span class="n">label</span><span class="o">=</span><span class="s">"fragment_three"</span>
          <span class="nl">tools:</span><span class="n">layout</span><span class="o">=</span><span class="s">"@layout/fragment_three"</span><span class="o">&gt;</span>
          <span class="o">&lt;</span><span class="n">action</span>
              <span class="nl">android:</span><span class="n">id</span><span class="o">=</span><span class="s">"@+id/action_threeFragment_to_oneFragment"</span>
              <span class="nl">app:</span><span class="n">destination</span><span class="o">=</span><span class="s">"@id/oneFragment"</span>
              <span class="nl">app:</span><span class="n">enterAnim</span><span class="o">=</span><span class="s">"@anim/slide_in_right"</span><span class="o">/&gt;</span>

      <span class="o">&lt;/</span><span class="n">fragment</span><span class="o">&gt;</span>
  <span class="o">&lt;/</span><span class="n">navigation</span><span class="o">&gt;</span>
</code></pre></div>    </div>
    <p><strong>é¡ºä¾¿é™„ä¸Šä»£ç ä¸­æåˆ°çš„ä»å³è¿›å…¥çš„åŠ¨ç”»é…ç½®ä»£ç </strong></p>
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="o">&lt;?</span><span class="n">xml</span> <span class="n">version</span><span class="o">=</span><span class="s">"1.0"</span> <span class="n">encoding</span><span class="o">=</span><span class="s">"utf-8"</span><span class="o">?&gt;</span>
  <span class="o">&lt;</span><span class="n">set</span> <span class="nl">xmlns:</span><span class="n">android</span><span class="o">=</span><span class="s">"http://schemas.android.com/apk/res/android"</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">translate</span>
          <span class="nl">android:</span><span class="n">duration</span><span class="o">=</span><span class="s">"600"</span>
          <span class="nl">android:</span><span class="n">fromXDelta</span><span class="o">=</span><span class="s">"100%"</span>
          <span class="nl">android:</span><span class="n">toXDelta</span><span class="o">=</span><span class="s">"0"</span> <span class="o">/&gt;</span>
  <span class="o">&lt;/</span><span class="n">set</span><span class="o">&gt;</span>
</code></pre></div>    </div>

    <blockquote>
      <p>æ³¨æ„ï¼šä¸Šè¯‰ä»£ç å¯é€šè¿‡å‰é¢åˆ—å‡ºçš„ç¬¬7æ¡åŠŸèƒ½è‡ªåŠ¨ç”Ÿæˆ</p>

      <p>ä»¥ä¸‹å°±æ˜¯é€šè¿‡ç‚¹å‡» <code class="highlighter-rouge">+</code> æŠŠä¸‰ä¸ªfragmentæ·»åŠ è¿›æ¥ï¼Œç„¶åè¿›è¡Œæ‰‹åŠ¨è¿çº¿ï¼Œæœ€åç”Ÿæˆä¸Šè¯‰ä»£ç ï¼Œæ˜¯ä¸æ˜¯å¾ˆç®€å•æ˜äº†ï¼</p>
    </blockquote>

    <p><img src="https://i.loli.net/2019/12/24/3DKrvwlkFb5VCam.png" alt="design.png" /></p>
  </li>
  <li>
    <p><em>æ¥ä¸‹æ¥ï¼Œå›åˆ°å’±ä»¬ activity çš„ layout æ–‡ä»¶ä¸­è¿›è¡Œé…ç½®ï¼Œä»¥ä¸‹è´´å‡º MainActivity çš„ layout ä»£ç ï¼š</em></p>

    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="o">&lt;?</span><span class="n">xml</span> <span class="n">version</span><span class="o">=</span><span class="s">"1.0"</span> <span class="n">encoding</span><span class="o">=</span><span class="s">"utf-8"</span><span class="o">?&gt;</span>
  <span class="o">&lt;</span><span class="n">layout</span>
      <span class="nl">xmlns:</span><span class="n">android</span><span class="o">=</span><span class="s">"http://schemas.android.com/apk/res/android"</span>
      <span class="nl">xmlns:</span><span class="n">app</span><span class="o">=</span><span class="s">"http://schemas.android.com/apk/res-auto"</span>
      <span class="nl">xmlns:</span><span class="n">tools</span><span class="o">=</span><span class="s">"http://schemas.android.com/tools"</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">androidx</span><span class="o">.</span><span class="na">constraintlayout</span><span class="o">.</span><span class="na">widget</span><span class="o">.</span><span class="na">ConstraintLayout</span>
          <span class="nl">android:</span><span class="n">layout_width</span><span class="o">=</span><span class="s">"match_parent"</span>
          <span class="nl">android:</span><span class="n">layout_height</span><span class="o">=</span><span class="s">"match_parent"</span>
          <span class="nl">tools:</span><span class="n">context</span><span class="o">=</span><span class="s">".MainActivity"</span><span class="o">&gt;</span>
          <span class="cm">/**
           * id å¿…é¡»è¦æœ‰
           * name å›ºå®šå¡«å†™ NavHostFragmentï¼Œç±»ä¼¼æ‰“ä¸ªæ ‡ç­¾ï¼ŒæŒ‡å®šä»–æ˜¯ NavHostFragment
           * defaultNavHost æ˜¯å¦æ‹¦æˆªè¿”å›é”®ï¼Œtrue åˆ™å¸®ä½ ç»´æŠ¤é¡µé¢æ ˆï¼ŒæŒ‰è¿”å›é”®ç›´æ¥è¿”å›ä¸Šä¸€ä¸ªé¡µé¢ï¼Œfalse åˆ™ç›´æ¥é€€å‡ºå½“å‰ activity 
           * navGraph æŒ‡å®šä¸Šé¢å’±ä»¬åˆ›å»ºçš„ navigation å¯¼èˆªæ–‡ä»¶
           **/</span>
          <span class="o">&lt;</span><span class="n">fragment</span>
              <span class="nl">android:</span><span class="n">id</span><span class="o">=</span><span class="s">"@+id/nav_host_fragment"</span>
              <span class="nl">android:</span><span class="n">name</span><span class="o">=</span><span class="s">"androidx.navigation.fragment.NavHostFragment"</span>
              <span class="nl">android:</span><span class="n">layout_width</span><span class="o">=</span><span class="s">"0dp"</span>
              <span class="nl">android:</span><span class="n">layout_height</span><span class="o">=</span><span class="s">"0dp"</span>
              <span class="nl">app:</span><span class="n">defaultNavHost</span><span class="o">=</span><span class="s">"true"</span>
              <span class="nl">app:</span><span class="n">layout_constraintBottom_toBottomOf</span><span class="o">=</span><span class="s">"parent"</span>
              <span class="nl">app:</span><span class="n">layout_constraintLeft_toLeftOf</span><span class="o">=</span><span class="s">"parent"</span>
              <span class="nl">app:</span><span class="n">layout_constraintRight_toRightOf</span><span class="o">=</span><span class="s">"parent"</span>
              <span class="nl">app:</span><span class="n">layout_constraintTop_toTopOf</span><span class="o">=</span><span class="s">"parent"</span>
              <span class="nl">app:</span><span class="n">navGraph</span><span class="o">=</span><span class="s">"@navigation/nav_graph_main"</span> <span class="o">/&gt;</span>
      <span class="o">&lt;/</span><span class="n">androidx</span><span class="o">.</span><span class="na">constraintlayout</span><span class="o">.</span><span class="na">widget</span><span class="o">.</span><span class="na">ConstraintLayout</span><span class="o">&gt;</span>
  <span class="o">&lt;/</span><span class="n">layout</span><span class="o">&gt;</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p><em>xmléƒ½é…ç½®å¥½å•¦ï¼ä¸‹é¢å›åˆ° fragment ä¸€å¥è¯è·³è½¬ fragmentï¼Œä¸‹é¢è´´å‡ºä¸¤ç§è·³è½¬æ–¹å¼çš„ä»£ç ï¼š</em></p>

    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="cm">/**
   *R.id.action_oneFragment_to_twoFragment2 æ˜¯ä¸Šè¯‰ navigation å¯¼èˆªé…ç½®æ–‡ä»¶å†… action æ ‡ç­¾çš„id
   **/</span>
  <span class="c1">//ç¬¬ä¸€ç§</span>
  <span class="n">binding</span><span class="o">.</span><span class="na">oneTv</span><span class="o">.</span><span class="na">setOnClickListener</span><span class="o">(</span><span class="k">new</span> <span class="nc">View</span><span class="o">.</span><span class="na">OnClickListener</span><span class="o">()</span> <span class="o">{</span>
      <span class="nd">@Override</span>
      <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onClick</span><span class="o">(</span><span class="nc">View</span> <span class="n">view</span><span class="o">)</span> <span class="o">{</span>
          <span class="nc">Navigation</span><span class="o">.</span><span class="na">findNavController</span><span class="o">(</span><span class="n">view</span><span class="o">).</span><span class="na">navigate</span><span class="o">(</span><span class="no">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">action_oneFragment_to_twoFragment2</span><span class="o">);</span>
      <span class="o">}</span>
   <span class="o">});</span>
  <span class="c1">//ç¬¬äºŒç§</span>
  <span class="n">binding</span><span class="o">.</span><span class="na">oneTv</span><span class="o">.</span><span class="na">setOnClickListener</span><span class="o">(</span><span class="nc">Navigation</span><span class="o">.</span><span class="na">createNavigateOnClickListener</span><span class="o">(</span><span class="no">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">action_oneFragment_to_twoFragment2</span><span class="o">));</span>
</code></pre></div>    </div>
    <p><em>createNavigateOnClickListener ç‚¹è¿›å»æŸ¥çœ‹æºç ï¼Œå‘ç°ä»–ä¹Ÿåªæ˜¯åšäº†å’Œç¬¬ä¸€ç§æ–¹æ³•ä¸€æ ·çš„æ“ä½œï¼Œä»¥ä¸‹ä¸ºæ­¤æ–¹æ³•æºç ï¼š</em></p>

    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="kd">public</span> <span class="kd">static</span> <span class="nc">View</span><span class="o">.</span><span class="na">OnClickListener</span> <span class="nf">createNavigateOnClickListener</span><span class="o">(</span><span class="nd">@IdRes</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">resId</span><span class="o">,</span>
          <span class="nd">@Nullable</span> <span class="kd">final</span> <span class="nc">Bundle</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
      <span class="k">return</span> <span class="k">new</span> <span class="nc">View</span><span class="o">.</span><span class="na">OnClickListener</span><span class="o">()</span> <span class="o">{</span>
          <span class="nd">@Override</span>
          <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onClick</span><span class="o">(</span><span class="nc">View</span> <span class="n">view</span><span class="o">)</span> <span class="o">{</span>
              <span class="n">findNavController</span><span class="o">(</span><span class="n">view</span><span class="o">).</span><span class="na">navigate</span><span class="o">(</span><span class="n">resId</span><span class="o">,</span> <span class="n">args</span><span class="o">);</span>
          <span class="o">}</span>
      <span class="o">};</span>
  <span class="o">}</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p><em>ä¸‰ä¸ª fragment éƒ½åŒä¸Šï¼Œé‚£ä¹ˆæ€ä¹ˆä¼ å€¼å‘ï¼Œä¸‹é¢ä»‹ç»ä¸¤ç§ä¼ å€¼æ–¹æ³•</em></p>

    <p>1.ä¼ ç»Ÿçš„ä¼ å€¼æ–¹å¼ï¼Œ<strong>Bundle</strong>ï¼ŒcreateNavigateOnClickListener ä¸ navigate éƒ½æä¾›äº†æ¥æ”¶ bundle çš„é‡è½½æ–¹æ³•ã€‚</p>

    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="c1">//å‘é€æ–¹</span>
  <span class="nc">Bundle</span> <span class="n">bundle</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Bundle</span><span class="o">();</span>
  <span class="n">bundle</span><span class="o">.</span><span class="na">putString</span><span class="o">(</span><span class="s">"message"</span><span class="o">,</span> <span class="s">"æˆ‘æ˜¯ä¼ è¿‡æ¥çš„å€¼"</span><span class="o">);</span>
  <span class="nc">Navigation</span><span class="o">.</span><span class="na">findNavController</span><span class="o">(</span><span class="n">view</span><span class="o">).</span><span class="na">navigate</span><span class="o">(</span><span class="no">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">action_oneFragment_to_twoFragment2</span><span class="o">,</span> <span class="n">bundle</span><span class="o">);</span>
  <span class="c1">//binding.oneTv.setOnClickListener(Navigation.createNavigateOnClickListener(R.id.action_oneFragment_to_twoFragment2, bundle));</span>
  <span class="c1">// æ¥æ”¶æ–¹</span>
  <span class="nc">Bundle</span> <span class="n">bundle</span> <span class="o">=</span> <span class="n">getArguments</span><span class="o">();</span>
  <span class="k">if</span> <span class="o">(</span><span class="n">bundle</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
      <span class="nc">String</span> <span class="n">str</span> <span class="o">=</span> <span class="n">bundle</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">"message"</span><span class="o">,</span> <span class="s">"æ²¡æœ‰ä¼ å€¼"</span><span class="o">);</span>
      <span class="n">binding</span><span class="o">.</span><span class="na">twoMessageTv</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="n">str</span><span class="o">);</span>
  <span class="o">}</span>
</code></pre></div>    </div>
    <p>2.navigation å®˜æ–¹æä¾›çš„ä¼ å€¼æ–¹æ³•</p>
    <ul>
      <li>åœ¨å·¥ç¨‹çš„ build.gradle æ–‡ä»¶å†…é…ç½®å¦‚ä¸‹ï¼š
        <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="n">dependencies</span> <span class="o">{</span>
  <span class="n">classpath</span> <span class="s">"android.arch.navigation:navigation-safe-args-gradle-plugin:1.0.0-rc02"</span>
  <span class="o">}</span>
</code></pre></div>        </div>
      </li>
      <li>åœ¨ Moudle ä¸‹çš„ build.gradle æ–‡ä»¶å†…é…ç½®å¦‚ä¸‹ï¼š
        <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="n">apply</span> <span class="nl">plugin:</span> <span class="err">'</span><span class="n">androidx</span><span class="o">.</span><span class="na">navigation</span><span class="o">.</span><span class="na">safeargs</span><span class="err">'</span>
</code></pre></div>        </div>
      </li>
      <li>
        <p>ä¼ ç»Ÿçš„ä¼ å€¼æ–¹å¼éœ€è¦çŸ¥é“key,è€Œ navigation ä¼šæ ¹æ®å¯¼èˆªæ–‡ä»¶çš„å‚æ•°é…ç½®ç”Ÿæˆè§„åˆ™ä¸ºï¼š<code class="highlighter-rouge">fragmentç±»å + Args</code> çš„ç±»æ–‡ä»¶ï¼Œä»¥ä¸‹é™„ä¸Š navigation å¯¼èˆªé…ç½®æ–‡ä»¶åŠ äº† argument æ ‡ç­¾çš„éƒ¨åˆ†ä»£ç  argument æ ‡ç­¾åœ¨ fragment æ ‡ç­¾å†…ã€‚</p>

        <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="o">&lt;</span><span class="n">fragment</span>
      <span class="nl">android:</span><span class="n">id</span><span class="o">=</span><span class="s">"@+id/oneFragment"</span>
      <span class="nl">android:</span><span class="n">name</span><span class="o">=</span><span class="s">"com.smodock.jetpackdemo.fragment.OneFragment"</span>
      <span class="nl">android:</span><span class="n">label</span><span class="o">=</span><span class="s">"fragment_one"</span>
      <span class="nl">tools:</span><span class="n">layout</span><span class="o">=</span><span class="s">"@layout/fragment_one"</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">action</span>
          <span class="nl">android:</span><span class="n">id</span><span class="o">=</span><span class="s">"@+id/action_oneFragment_to_twoFragment2"</span>
          <span class="nl">app:</span><span class="n">destination</span><span class="o">=</span><span class="s">"@id/twoFragment"</span>
          <span class="nl">app:</span><span class="n">enterAnim</span><span class="o">=</span><span class="s">"@anim/slide_in_right"</span><span class="o">/&gt;</span>
      <span class="o">&lt;</span><span class="n">argument</span>
          <span class="nl">android:</span><span class="n">name</span><span class="o">=</span><span class="s">"message"</span>
          <span class="nl">app:</span><span class="n">argType</span><span class="o">=</span><span class="s">"string"</span>
          <span class="nl">android:</span><span class="n">defaultValue</span><span class="o">=</span><span class="s">"æˆ‘æ˜¯é»˜è®¤å€¼"</span> <span class="o">/&gt;</span>
  <span class="o">&lt;/</span><span class="n">fragment</span><span class="o">&gt;</span>
</code></pre></div>        </div>
      </li>
      <li>
        <p>fragment ä¸­ é€šè¿‡åˆå§‹åŒ– <code class="highlighter-rouge">xxxArgs.Builder</code> set ä¸Šé¢é…ç½®çš„ argument çš„ nameï¼ŒBuider å†…éƒ¨é™æ€ç±»é‡Œé¢é€šè¿‡æ˜ å°„ä¸Šé¢é…ç½®æ–‡ä»¶è‡ªåŠ¨ç”Ÿæˆå¯¹åº” <code class="highlighter-rouge">name</code> å­—æ®µå†…å®¹çš„ <code class="highlighter-rouge">get ä¸ set</code> æ–¹æ³•ï¼Œä»¥ä¸‹é™„ä¸Šä¼ å€¼ä¸å–å€¼çš„ä»£ç ï¼š</p>

        <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="c1">//å‘é€æ–¹</span>
  <span class="nc">OneFragmentArgs</span><span class="o">.</span><span class="na">Builder</span> <span class="n">builder</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">OneFragmentArgs</span><span class="o">.</span><span class="na">Builder</span><span class="o">();</span>
  <span class="nc">Bundle</span> <span class="n">bundle</span> <span class="o">=</span> <span class="n">builder</span><span class="o">.</span><span class="na">setMessage</span><span class="o">(</span><span class="s">"æˆ‘æ˜¯å¦ä¸€ç§æ–¹æ³•è½¬è¿‡æ¥çš„å€¼"</span><span class="o">).</span><span class="na">build</span><span class="o">().</span><span class="na">toBundle</span><span class="o">();</span>
  <span class="nc">Navigation</span><span class="o">.</span><span class="na">findNavController</span><span class="o">(</span><span class="n">view</span><span class="o">).</span><span class="na">navigate</span><span class="o">(</span><span class="no">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">action_oneFragment_to_twoFragment2</span><span class="o">,</span> <span class="n">bundle</span><span class="o">);</span>
	
  <span class="c1">//æ¥æ”¶æ–¹</span>
  <span class="nc">Bundle</span> <span class="n">bundle</span> <span class="o">=</span> <span class="n">getArguments</span><span class="o">();</span>
  <span class="k">if</span> <span class="o">(</span><span class="n">bundle</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
      <span class="nc">String</span> <span class="n">str</span> <span class="o">=</span> <span class="nc">OneFragmentArgs</span><span class="o">.</span><span class="na">fromBundle</span><span class="o">(</span><span class="n">bundle</span><span class="o">).</span><span class="na">getMessage</span><span class="o">();</span>
      <span class="n">binding</span><span class="o">.</span><span class="na">twoMessageTv</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="n">str</span><span class="o">);</span>
  <span class="o">}</span>
</code></pre></div>        </div>
      </li>
    </ul>
  </li>
  <li>
    <p><em>ç°åœ¨åŸºæœ¬çš„è·³è½¬ fragment å¤§å®¶éƒ½ä¼šå•¦ï¼Œé‚£å›åˆ°ä¸Šé¢æåˆ°çš„ Navigation ç»„ä»¶åŠŸèƒ½çš„ç¬¬5æ¡ï¼Œç”¨åº•éƒ¨å¯¼èˆªä¸ºä¾‹å­ï¼Œæ¯•ç«Ÿåœ¨æ—¥å¸¸éœ€æ±‚ä¸­åº•éƒ¨å¯¼èˆªåŸºæœ¬éå¸ƒå¤§éƒ¨åˆ†çš„ APP å†…ï¼Œå®˜æ–¹æå‡ºäº† <code class="highlighter-rouge">BottomNavigationView</code> ä¸ <code class="highlighter-rouge">NavigationUI</code> æ­é…çš„ä¸€æ¬¾è¶…ç®€æ´çš„åº•éƒ¨å¯¼èˆªæ ã€‚</em></p>

    <ol>
      <li>æ·»åŠ  <code class="highlighter-rouge">BottomNavigationView</code> çš„ä¾èµ–
        <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="n">implementation</span> <span class="err">'</span><span class="n">com</span><span class="o">.</span><span class="na">google</span><span class="o">.</span><span class="na">android</span><span class="o">.</span><span class="na">material</span><span class="o">:</span><span class="nl">material:</span><span class="mf">1.2</span><span class="o">.</span><span class="mi">0</span><span class="o">-</span><span class="n">alpha02</span><span class="err">'</span>
</code></pre></div>        </div>
      </li>
      <li>
        <p>å¦‚ navigation éœ€è¦åˆ›å»ºå¯¼èˆªæ–‡ä»¶ï¼Œ <code class="highlighter-rouge">BottomNavigationView</code> éœ€è¦åˆ›å»ºèœå•æ–‡ä»¶ï¼Œåˆ›å»ºåä¸º menu çš„æ–‡ä»¶å¤¹ï¼Œè·¯å¾„ä¸º app &gt; src &gt; main &gt; res &gt; menuï¼Œåœ¨ navigation æ–‡ä»¶å¤¹ä¸‹é¢æ–°å»º xxx.xml æ–‡ä»¶ï¼Œä»¥ä¸‹ç¤ºä¾‹ä»£ç ï¼š</p>

        <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="o">&lt;?</span><span class="n">xml</span> <span class="n">version</span><span class="o">=</span><span class="s">"1.0"</span> <span class="n">encoding</span><span class="o">=</span><span class="s">"utf-8"</span><span class="o">?&gt;</span>
 <span class="o">&lt;</span><span class="n">menu</span> <span class="nl">xmlns:</span><span class="n">android</span><span class="o">=</span><span class="s">"http://schemas.android.com/apk/res/android"</span><span class="o">&gt;</span>
     <span class="cm">/**
      * id ä¸º navigation å¯¼èˆªæ–‡ä»¶å†… fragment æ ‡ç­¾è®¾ç½®çš„id
      * icon ä¸ºä»»æ„ icon å›¾ç‰‡
      * title ä¸ºå¯¼èˆªæ  icon ä¸‹é¢çš„æ–‡å­—
      **/</span>
     <span class="o">&lt;</span><span class="n">item</span>
         <span class="nl">android:</span><span class="n">id</span><span class="o">=</span><span class="s">"@id/oneFragment"</span>
         <span class="nl">android:</span><span class="n">icon</span><span class="o">=</span><span class="s">"@drawable/ic_launcher_background"</span>
         <span class="nl">android:</span><span class="n">title</span><span class="o">=</span><span class="s">"One"</span> <span class="o">/&gt;</span>
     <span class="o">&lt;</span><span class="n">item</span>
         <span class="nl">android:</span><span class="n">id</span><span class="o">=</span><span class="s">"@id/twoFragment"</span>
         <span class="nl">android:</span><span class="n">icon</span><span class="o">=</span><span class="s">"@drawable/ic_launcher_background"</span>
         <span class="nl">android:</span><span class="n">title</span><span class="o">=</span><span class="s">"Two"</span> <span class="o">/&gt;</span>
     <span class="o">&lt;</span><span class="n">item</span>
         <span class="nl">android:</span><span class="n">id</span><span class="o">=</span><span class="s">"@id/threeFragment"</span>
         <span class="nl">android:</span><span class="n">icon</span><span class="o">=</span><span class="s">"@drawable/ic_launcher_background"</span>
         <span class="nl">android:</span><span class="n">title</span><span class="o">=</span><span class="s">"Three"</span> <span class="o">/&gt;</span>
 <span class="o">&lt;/</span><span class="n">menu</span><span class="o">&gt;</span>
</code></pre></div>        </div>
      </li>
      <li>
        <p>activity çš„ layout æ–‡ä»¶å†…æ·»åŠ  <code class="highlighter-rouge">BottomNavigationView</code> çš„ä½¿ç”¨ï¼Œåœ¨åŸåŸºç¡€ä¸‹æ·»åŠ å¦‚ä¸‹ä»£ç ï¼š</p>

        <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="o">&lt;</span><span class="n">fragment</span>
     <span class="nl">android:</span><span class="n">id</span><span class="o">=</span><span class="s">"@+id/nav_host_fragment"</span>
     <span class="nl">android:</span><span class="n">name</span><span class="o">=</span><span class="s">"androidx.navigation.fragment.NavHostFragment"</span>
     <span class="nl">android:</span><span class="n">layout_width</span><span class="o">=</span><span class="s">"0dp"</span>
     <span class="nl">android:</span><span class="n">layout_height</span><span class="o">=</span><span class="s">"0dp"</span>
     <span class="nl">app:</span><span class="n">defaultNavHost</span><span class="o">=</span><span class="s">"false"</span>
     <span class="nl">app:</span><span class="n">layout_constraintBottom_toBottomOf</span><span class="o">=</span><span class="s">"parent"</span>
     <span class="nl">app:</span><span class="n">layout_constraintLeft_toLeftOf</span><span class="o">=</span><span class="s">"parent"</span>
     <span class="nl">app:</span><span class="n">layout_constraintRight_toRightOf</span><span class="o">=</span><span class="s">"parent"</span>
     <span class="nl">app:</span><span class="n">layout_constraintTop_toTopOf</span><span class="o">=</span><span class="s">"parent"</span>
     <span class="nl">app:</span><span class="n">navGraph</span><span class="o">=</span><span class="s">"@navigation/nav_graph_main"</span> <span class="o">/&gt;</span>
 <span class="c1">//ä»¥ä¸‹ä¸ºæ–°æ·»åŠ çš„ä»£ç </span>
 <span class="c1">//menu ä¸ä¸Šé¢æˆ‘ä»¬æ–°å»ºçš„ç»‘å®š</span>
 <span class="o">&lt;</span><span class="n">com</span><span class="o">.</span><span class="na">google</span><span class="o">.</span><span class="na">android</span><span class="o">.</span><span class="na">material</span><span class="o">.</span><span class="na">bottomnavigation</span><span class="o">.</span><span class="na">BottomNavigationView</span>
     <span class="nl">android:</span><span class="n">id</span><span class="o">=</span><span class="s">"@+id/bottom_nav_view"</span>
     <span class="nl">android:</span><span class="n">layout_width</span><span class="o">=</span><span class="s">"match_parent"</span>
     <span class="nl">android:</span><span class="n">layout_height</span><span class="o">=</span><span class="s">"wrap_content"</span>
     <span class="nl">app:</span><span class="n">menu</span><span class="o">=</span><span class="s">"@menu/bottom_nav_menu"</span>
     <span class="nl">app:</span><span class="n">layout_constraintBottom_toBottomOf</span><span class="o">=</span><span class="s">"parent"</span>
     <span class="nl">android:</span><span class="n">background</span><span class="o">=</span><span class="s">"#ffffff"</span>
     <span class="nl">app:</span><span class="n">itemTextColor</span><span class="o">=</span><span class="s">"@color/colorAccent"</span><span class="o">/&gt;</span>
</code></pre></div>        </div>
      </li>
      <li>
        <p>æ¥ä¸‹æ¥ activity å†…å·²éå¸¸ç®€æ´çš„ä»£ç å°† <code class="highlighter-rouge">NavController</code> ä¸ <code class="highlighter-rouge">BottomNavigationView</code> ç»‘å®š</p>

        <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="nc">NavController</span> <span class="n">navController</span> <span class="o">=</span> <span class="nc">Navigation</span><span class="o">.</span><span class="na">findNavController</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="no">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">nav_host_fragment</span><span class="o">);</span>
 <span class="nc">NavigationUI</span><span class="o">.</span><span class="na">setupWithNavController</span><span class="o">(</span><span class="n">binding</span><span class="o">.</span><span class="na">bottomNavView</span><span class="o">,</span> <span class="n">navController</span><span class="o">);</span>
</code></pre></div>        </div>
        <p><strong>æ•ˆæœå›¾å¦‚ä¸‹</strong></p>

        <p><img src="https://i.loli.net/2019/12/24/ODX4il1GZMS8jL2.png" alt="navigation.png" /></p>
      </li>
    </ol>
  </li>
</ul>

<h3 id="happy-ending">Happy Endingï¼</h3>

<h3 id="æ€»ç»“">æ€»ç»“</h3>

<p>é€šè¿‡è¿™ä¸ªå°Demo ä¸ªäººæ„Ÿè§‰ Navigation è¿˜æ˜¯å¡«è¡¥äº†åŸç”Ÿ fragment ç®¡ç†ä¸Šçš„ç¼ºå¤±ï¼Œä½¿è·³è½¬ä¸å›é€€å˜å¾—éå¸¸ç®€æ´ï¼Œä½†æ˜¯ç”¨åˆ°åº•éƒ¨å¯¼èˆªåå‘ç°ï¼Œé€šè¿‡åº•éƒ¨tabåˆ‡æ¢ fragment é™¤äº†åˆå§‹é¡µé¢ï¼Œå…¶ä»–é¡µé¢æ˜¯ä¼šæ¯æ¬¡é‡æ–°åˆ›å»ºï¼Œéœ€ç»“åˆViewModel æ–¹èƒ½è¾¾åˆ°æœ€ä½³æ•ˆæœã€‚</p>

:ET